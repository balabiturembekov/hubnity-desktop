# UI BUGS REPORT

**–î–∞—Ç–∞:** 2025-01-08  
**–°—Ç–∞—Ç—É—Å:** –ù–∞–π–¥–µ–Ω–æ 5 –±–∞–≥–æ–≤

---

## üî¥ BUG #1: Race Condition –≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–§–∞–π–ª:** `src/components/Timer.tsx`  
**–°—Ç—Ä–æ–∫–∏:** 45-57

**–ü—Ä–æ–±–ª–µ–º–∞:**
–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–∑ Rust –≤ store –º–æ–∂–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –∏–∑ –º–µ—Ç–æ–¥–æ–≤ `startTracking()`, `pauseTracking()`, –∏ —Ç.–¥. –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ "–º–µ—Ä—Ü–∞–Ω–∏—é" –∫–Ω–æ–ø–æ–∫ –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—é —Å–æ—Å—Ç–æ—è–Ω–∏—è.

**–ö–æ–¥:**
```typescript
// –û–±–Ω–æ–≤–ª—è–µ–º store —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
const { isTracking: currentIsTracking, isPaused: currentIsPaused } = useTrackerStore.getState();
if (currentIsTracking !== isRunning || currentIsPaused !== isPaused) {
  useTrackerStore.setState({
    isTracking: isRunning || isPaused, // Tracking –µ—Å–ª–∏ RUNNING –∏–ª–∏ PAUSED
    isPaused: isPaused,
  });
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–°—Ç–∞—Ä—Ç", `startTracking()` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `isTracking: true`
- –ù–æ —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑ Rust –º–æ–∂–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ
- –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –º–µ—Ä—Ü–∞–Ω–∏—é UI

**–†–µ—à–µ–Ω–∏–µ:**
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `timerState` –Ω–∞–ø—Ä—è–º—É—é –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫, –∞ –Ω–µ –ø–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–∞ store.

---

## üî¥ BUG #2: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ isTracking

**–§–∞–π–ª:** `src/components/Timer.tsx`  
**–°—Ç—Ä–æ–∫–∏:** 54

**–ü—Ä–æ–±–ª–µ–º–∞:**
`isTracking: isRunning || isPaused` –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ï—Å–ª–∏ —Ç–∞–π–º–µ—Ä STOPPED, –Ω–æ –≤ store `isPaused=true`, —Ç–æ `isTracking` –±—É–¥–µ—Ç `true`, —á—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.

**–ö–æ–¥:**
```typescript
isTracking: isRunning || isPaused, // Tracking –µ—Å–ª–∏ RUNNING –∏–ª–∏ PAUSED
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ï—Å–ª–∏ `isRunning=false` –∏ `isPaused=false` (STOPPED), –Ω–æ –≤ store `isPaused=true`, —Ç–æ `isTracking` –±—É–¥–µ—Ç `false`
- –ù–æ –µ—Å–ª–∏ `isRunning=false` –∏ `isPaused=true`, —Ç–æ `isTracking` –±—É–¥–µ—Ç `true` - —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ù–æ –µ—Å–ª–∏ `isRunning=false` –∏ `isPaused=false`, —Ç–æ `isTracking` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `false`, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç store

**–†–µ—à–µ–Ω–∏–µ:**
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `isRunning || isPaused` –Ω–∞–ø—Ä—è–º—É—é –∏–∑ `timerState`, –∞ –Ω–µ –∏–∑ store.

---

## üî¥ BUG #3: Day Change Check –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –≤–º–µ—Å—Ç–æ UTC

**–§–∞–π–ª:** `src/components/Timer.tsx`  
**–°—Ç—Ä–æ–∫–∏:** 93-98

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `toDateString()` –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–∞—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è, –∞ –Ω–µ UTC. –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ–±–ª–µ–º–∞–º –ø—Ä–∏ —Å–º–µ–Ω–µ timezone –∏–ª–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ –≤ —Ä–∞–∑–Ω—ã—Ö timezone.

**–ö–æ–¥:**
```typescript
const today = new Date();
const dayStartTimestamp = timerState.day_start;

// –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–º–µ–Ω–∏–ª—Å—è –ª–∏ –¥–µ–Ω—å (—Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –¥–∞—Ç—ã, –Ω–µ —Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è)
const dayStartDate = new Date(dayStartTimestamp * 1000);
const isDifferentDay = dayStartDate.toDateString() !== today.toDateString();
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Rust –∏—Å–ø–æ–ª—å–∑—É–µ—Ç UTC –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–Ω—è
- Frontend –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
- –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ —Å–º–µ–Ω–µ timezone

**–†–µ—à–µ–Ω–∏–µ:**
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å UTC –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–∞—Ç, –∫–∞–∫ –≤ Rust.

---

## üî¥ BUG #4: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ isPaused –∏–∑ store –≤–º–µ—Å—Ç–æ timerState

**–§–∞–π–ª:** `src/components/Timer.tsx`  
**–°—Ç—Ä–æ–∫–∏:** 203, 221-225

**–ü—Ä–æ–±–ª–µ–º–∞:**
–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∏ idle time –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `isPaused` –∏–∑ store, –∞ –Ω–µ –∏–∑ `timerState`. –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.

**–ö–æ–¥:**
```typescript
{isPaused && idlePauseStartTime && (
  // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ idle time
)}

<span>
  {isPaused 
    ? (idlePauseStartTime ? '–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ (–Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏)' : '–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ')
    : isTracking 
    ? '–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è' 
    : '–ù–µ –∑–∞–ø—É—â–µ–Ω–æ'}
</span>
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `isPaused` –±–µ—Ä–µ—Ç—Å—è –∏–∑ store, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω —Å `timerState`
- –ï—Å–ª–∏ Rust —Ç–∞–π–º–µ—Ä –Ω–∞ –ø–∞—É–∑–µ, –Ω–æ store –µ—â–µ –Ω–µ –æ–±–Ω–æ–≤–ª–µ–Ω, UI –ø–æ–∫–∞–∂–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å

**–†–µ—à–µ–Ω–∏–µ:**
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `timerState.state.state === 'PAUSED'` –≤–º–µ—Å—Ç–æ `isPaused` –∏–∑ store.

---

## üî¥ BUG #5: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç store –≤–º–µ—Å—Ç–æ timerState

**–§–∞–π–ª:** `src/components/Timer.tsx`  
**–°—Ç—Ä–æ–∫–∏:** 231-277

**–ü—Ä–æ–±–ª–µ–º–∞:**
–õ–æ–≥–∏–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `isTracking` –∏ `isPaused` –∏–∑ store, –∞ –Ω–µ –∏–∑ `timerState`. –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—é –∫–Ω–æ–ø–æ–∫.

**–ö–æ–¥:**
```typescript
{!isTracking ? (
  <Button onClick={handleStart}>–°—Ç–∞—Ä—Ç</Button>
) : (
  <>
    {isPaused ? (
      <Button onClick={handleResume}>–í–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å</Button>
    ) : (
      <Button onClick={handlePause}>–ü–∞—É–∑–∞</Button>
    )}
  </>
)}
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ï—Å–ª–∏ Rust —Ç–∞–π–º–µ—Ä RUNNING, –Ω–æ store –µ—â–µ –Ω–µ –æ–±–Ω–æ–≤–ª–µ–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ "–°—Ç–∞—Ä—Ç" –≤–º–µ—Å—Ç–æ "–ü–∞—É–∑–∞"
- –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—É—Ç–∞–Ω–∏—Ü–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–†–µ—à–µ–Ω–∏–µ:**
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `timerState.state.state` –Ω–∞–ø—Ä—è–º—É—é –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫.

---

## ‚úÖ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Æ

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–Ω–æ):
1. **BUG #5**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `timerState` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫
2. **BUG #4**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `timerState` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–∞–∂–Ω–æ):
3. **BUG #3**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å UTC –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–∞—Ç
4. **BUG #2**: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É `isTracking`

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–£–ª—É—á—à–µ–Ω–∏–µ):
5. **BUG #1**: –£–ª—É—á—à–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å–æ—Å—Ç–æ—è–Ω–∏—è

---

## üìù –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `timerState.state.state` –Ω–∞–ø—Ä—è–º—É—é –¥–ª—è –≤—Å–µ—Ö UI —ç–ª–µ–º–µ–Ω—Ç–æ–≤
2. –£–±—Ä–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç `isTracking` –∏ `isPaused` –∏–∑ store –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å UTC –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–∞—Ç
4. –£–ª—É—á—à–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É Rust –∏ store

---

**–û—Ç—á–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω:** 2025-01-08  
**–ù–∞–π–¥–µ–Ω–æ 5 –±–∞–≥–æ–≤ –≤ UI**
