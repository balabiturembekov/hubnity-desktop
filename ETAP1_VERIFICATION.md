# –≠–¢–ê–ü 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–æ–º–µ–Ω—Ç–æ–≤ ‚úÖ

## üî¥ 1. Instant + PAUSE - –ü–†–û–í–ï–†–ï–ù–û ‚úÖ

### pause()
```rust
// –ü—Ä–∏ pause():
1. –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è —Å–µ—Å—Å–∏–∏: accumulated += (now - session_start)
2. –û—á–∏—â–∞–µ–º session_start_instant = None ‚úÖ
3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º state = Paused
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –í—Ä–µ–º—è –ù–ï —Ç–µ—Ä—è–µ—Ç—Å—è, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `accumulated`

### resume()
```rust
// –ü—Ä–∏ resume():
1. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—ã–π session_start_instant = Instant::now() ‚úÖ
2. –û–±–Ω–æ–≤–ª—è–µ–º session_start_timestamp ‚úÖ
3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º state = Running
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ù–æ–≤–∞—è —Å–µ—Å—Å–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞

### get_state() - elapsed()
```rust
// –§–æ—Ä–º—É–ª–∞ elapsed:
match state {
    Running => accumulated + (now - session_start_instant) ‚úÖ
    Paused | Stopped => accumulated ‚úÖ
}
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è RUNNING

**–í–´–í–û–î:** ‚úÖ –ù–µ—Ç "–ø—Ä—ã–∂–∫–æ–≤ –≤—Ä–µ–º–µ–Ω–∏", –ª–æ–≥–∏–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞

---

## üî¥ 2. –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å - –ü–†–û–í–ï–†–ï–ù–û ‚úÖ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ TimerEngine:
```rust
struct TimerEngine {
    state: Arc<Mutex<TimerState>>, ‚úÖ
    session_start_instant: Arc<Mutex<Option<Instant>>>, ‚úÖ
    session_start_timestamp: Arc<Mutex<Option<u64>>>, ‚úÖ
    accumulated_seconds: Arc<Mutex<u64>>, ‚úÖ
    last_known_instant: Arc<Mutex<Instant>>, ‚úÖ
    day_start_timestamp: Arc<Mutex<Option<u64>>>, ‚úÖ
}
```
**–í—Å–µ –ø–æ–ª—è –∑–∞—â–∏—â–µ–Ω—ã Mutex** ‚úÖ

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Tauri State:
```rust
// –í run():
.manage(TimerEngine::new()) ‚úÖ

// –í –∫–æ–º–∞–Ω–¥–∞—Ö:
async fn start_timer(engine: State<'_, TimerEngine>) ‚úÖ
```
**–û–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –Ω–∞ –≤—Å—ë –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** ‚úÖ

**–í–´–í–û–î:** ‚úÖ –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –æ–±–µ—Å–ø–µ—á–µ–Ω–∞

---

## üî¥ 3. get_timer_state() - –ü–†–û–í–ï–†–ï–ù–û ‚úÖ

### –ú–µ—Ç–æ–¥ —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞–µ—Ç:
```rust
fn get_state(&self) -> Result<TimerStateResponse, String> {
    // –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏—è:
    let state = *self.state.lock()?; ‚úÖ (–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ)
    let accumulated = *self.accumulated_seconds.lock()?; ‚úÖ (–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ)
    let session_start_instant = *self.session_start_instant.lock()?; ‚úÖ (–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ)
    
    // –†–∞—Å—á–µ—Ç elapsed (—Ç–æ–∂–µ —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ):
    let elapsed_seconds = match state {
        Running => accumulated + (now - session_start),
        _ => accumulated
    };
    
    Ok(TimerStateResponse { ... }) ‚úÖ
}
```

**–í–ê–ñ–ù–û:** 
- ‚úÖ –ù–µ—Ç –º—É—Ç–∞—Ü–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ –∏ —Ä–∞—Å—á–µ—Ç
- ‚úÖ –ú–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ –∏–∑ –ª—é–±–æ–≥–æ –ø–æ—Ç–æ–∫–∞

**–í–´–í–û–î:** ‚úÖ –ú–µ—Ç–æ–¥ —á–∏—Å—Ç—ã–π (pure function)

---

## üü° 4. reset_timer_day - –ò–°–ü–†–ê–í–õ–ï–ù–û ‚úÖ

### –ë—ã–ª–æ:
```rust
fn reset_day(&self) -> Result<(), String> {
    // –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ RUNNING ‚ùå
    *accumulated = 0;
    // ...
}
```

### –°—Ç–∞–ª–æ:
```rust
fn reset_day(&self) -> Result<(), String> {
    let state = {
        let state_lock = self.state.lock()?;
        *state_lock // –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º lock
    };
    
    match state {
        TimerState::Running => {
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—Ä–µ–¥ reset ‚úÖ
            self.stop()?;
        }
        TimerState::Paused | TimerState::Stopped => {
            // –ú–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å
        }
    }
    
    // –¢–µ–ø–µ—Ä—å –±–µ–∑–æ–ø–∞—Å–Ω–æ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º
    *accumulated = 0;
    // ...
}
```

**–í–´–í–û–î:** ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ—Ç–µ—Ä–∏ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ reset –≤–æ –≤—Ä–µ–º—è RUNNING

---

## üìã –ò–¢–û–ì–û–í–ê–Ø –ü–†–û–í–ï–†–ö–ê

| –ü—É–Ω–∫—Ç | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-------|--------|-------------|
| 1. Instant + PAUSE | ‚úÖ | –í—Ä–µ–º—è –Ω–µ —Ç–µ—Ä—è–µ—Ç—Å—è, resume –æ–±–Ω–æ–≤–ª—è–µ—Ç instant |
| 2. –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | ‚úÖ | Arc<Mutex<>>, –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä —á–µ—Ä–µ–∑ State |
| 3. get_timer_state() | ‚úÖ | –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ, –Ω–µ—Ç –º—É—Ç–∞—Ü–∏–π |
| 4. reset_timer_day | ‚úÖ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç RUNNING |

---

## ‚úÖ –≠–¢–ê–ü 1 –ó–ê–°–ß–ò–¢–ê–ù –ù–ê 100%

**Timer Engine –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:**
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å Instant
- ‚úÖ –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ –ß–∏—Å—Ç—ã–π get_state()
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫ –≤ reset_day()

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Frontend
