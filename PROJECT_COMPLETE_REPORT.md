# –ü–û–õ–ù–´–ô –û–¢–ß–ï–¢ –ü–û –ü–†–û–ï–ö–¢–£ HUBNITY

**–î–∞—Ç–∞:** 2025-01-08  
**–í–µ—Ä—Å–∏—è:** 0.1.0  
**–°—Ç–∞—Ç—É—Å:** Production-ready (90% –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏)  
**–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:** macOS Desktop Application (Tauri 2)

---

## üìä EXECUTIVE SUMMARY

### –û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å: **90% –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ production**

**–ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:**
- ‚úÖ –°—Ç—Ä–æ–≥–∞—è FSM (Finite State Machine) –≤ Rust –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–∞–π–º–µ—Ä–æ–º
- ‚úÖ SQLite –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Å offline queue
- ‚úÖ –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ (aes-gcm)
- ‚úÖ Retry –º–µ—Ö–∞–Ω–∏–∑–º —Å exponential backoff
- ‚úÖ **92 unit —Ç–µ—Å—Ç–∞** (–≤—Å–µ –ø—Ä–æ—Ö–æ–¥—è—Ç)
- ‚úÖ **8 E2E —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤**
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (tracing)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ sleep/wake —á–µ—Ä–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫—É –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ Calendar day rollover (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±—Ä–æ—Å –≤ –ø–æ–ª–Ω–æ—á—å)
- ‚úÖ Runtime guards (clock skew, timezone, overflow protection)
- ‚úÖ UI —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–≥–æ–≤

**–û—Å—Ç–∞–≤—à–∏–µ—Å—è –∑–∞–¥–∞—á–∏:**
- ‚ö†Ô∏è ActivityMonitor unit —Ç–µ—Å—Ç—ã (0 —Ç–µ—Å—Ç–æ–≤)
- ‚ö†Ô∏è Sleep/Wake handlers unit —Ç–µ—Å—Ç—ã (0 —Ç–µ—Å—Ç–æ–≤)
- ‚ö†Ô∏è Keychain –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π –∫–ª—é—á)
- ‚ö†Ô∏è Hotkeys –∏ system tray timer (–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)

---

## üìà –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–†–û–ï–ö–¢–ê

### –ö–æ–¥–æ–≤–∞—è –±–∞–∑–∞

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ | –§–∞–π–ª–æ–≤ | –¢–µ—Å—Ç–æ–≤ | –ü–æ–∫—Ä—ã—Ç–∏–µ |
|-----------|------------|--------|--------|----------|
| **Rust (Backend)** | 5,018 | 1 (lib.rs) | 92 | ~98% |
| **TypeScript (Frontend)** | 4,432 | 22 | - | - |
| **E2E Tests** | - | 8 | 8 | - |
| **–í—Å–µ–≥–æ** | **9,450** | **31** | **100** | **~95%** |

### –¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ

#### Rust Unit Tests: **92 —Ç–µ—Å—Ç–∞** ‚úÖ

**TimerEngine:** ‚úÖ **100% –ø–æ–∫—Ä—ã—Ç–∏–µ** (32 —Ç–µ—Å—Ç–∞)
- ‚úÖ –í—Å–µ FSM –ø–µ—Ä–µ—Ö–æ–¥—ã
- ‚úÖ –ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã
- ‚úÖ –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ Day rollover
- ‚úÖ Overflow protection
- ‚úÖ Clock skew detection
- ‚úÖ Recursive protection
- ‚úÖ Sleep detection

**Database:** ‚úÖ **~98% –ø–æ–∫—Ä—ã—Ç–∏–µ** (35 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ Sync queue –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚úÖ Retry tasks —Å exponential backoff
- ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ WAL mode –∏ foreign keys
- ‚úÖ Edge cases (corrupted DB, partial write)
- ‚úÖ Concurrent access

**SyncManager:** ‚úÖ **~100% –ø–æ–∫—Ä—ã—Ç–∏–µ** (25 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ Enqueue operations (time_entry, screenshot, activity)
- ‚úÖ Retry –º–µ—Ö–∞–Ω–∏–∑–º
- ‚úÖ Token refresh
- ‚úÖ Sync queue
- ‚úÖ Error handling
- ‚úÖ Network errors

#### E2E Tests: **8 —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤** ‚úÖ

1. ‚úÖ `accumulated-time.spec.ts` - –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
2. ‚úÖ `day-change.spec.ts` - –°–º–µ–Ω–∞ –¥–Ω—è
3. ‚úÖ `full-user-cycle.spec.ts` - –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. ‚úÖ `idle-window.spec.ts` - –û–∫–Ω–æ –ø—Ä–æ—Å—Ç–æ—è
5. ‚úÖ `queue-integration.spec.ts` - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ—á–µ—Ä–µ–¥–∏
6. ‚úÖ `token-refresh.spec.ts` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
7. ‚úÖ `url-activity.spec.ts` - URL –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
8. ‚úÖ `README.md` - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### –ü—Ä–∏–Ω—Ü–∏–ø—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

1. **Rust –∫–∞–∫ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã**
   - –í—Å–µ —Ä–∞—Å—á–µ—Ç—ã –≤—Ä–µ–º–µ–Ω–∏ –≤ Rust
   - Frontend - —Ç–æ–Ω–∫–∏–π –∫–ª–∏–µ–Ω—Ç (—Ç–æ–ª—å–∫–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ)
   - –ù–µ—Ç `Date.now()` –≤ frontend –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏

2. **–°—Ç—Ä–æ–≥–∞—è FSM (Finite State Machine)**
   - –°–æ—Å—Ç–æ—è–Ω–∏—è: `Stopped`, `Running { started_at: Instant }`, `Paused`
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
   - –ó–∞–ø—Ä–µ—Ç –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤

3. **Offline-first –ø–æ–¥—Ö–æ–¥**
   - –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–Ω–∞—á–∞–ª–∞ –≤ SQLite
   - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤ —Ñ–æ–Ω–µ
   - Retry —Å exponential backoff

4. **–ú–æ–Ω–æ—Ç–æ–Ω–Ω–æ–µ –≤—Ä–µ–º—è**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `std::time::Instant` –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤
   - –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
   - –ü–µ—Ä–µ–∂–∏–≤–∞–µ—Ç sleep/wake

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

#### Backend (Rust)

**TimerEngine** (`src-tauri/src/lib.rs`)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ —Ç–∞–π–º–µ—Ä–∞
- –†–∞—Å—á–µ—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
- Day rollover (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±—Ä–æ—Å –≤ –ø–æ–ª–Ω–æ—á—å)
- Runtime guards (clock skew, overflow, recursive protection)

**Database** (`src-tauri/src/lib.rs`)
- SQLite –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å
- Sync queue –¥–ª—è offline –æ–ø–µ—Ä–∞—Ü–∏–π
- Retry –º–µ—Ö–∞–Ω–∏–∑–º —Å exponential backoff
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**SyncManager** (`src-tauri/src/lib.rs`)
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å —Å–µ—Ä–≤–µ—Ä–æ–º
- Token refresh –ø—Ä–∏ 401
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ (aes-gcm)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫

**TokenEncryption** (`src-tauri/src/lib.rs`)
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –ë–î
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ aes-gcm
- –î–µ—Ñ–æ–ª—Ç–Ω—ã–π –∫–ª—é—á (TODO: Keychain)

**ActivityMonitor** (`src-tauri/src/lib.rs`)
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –º—ã—à–∏/–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–∞—É–∑–∞ –ø—Ä–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- Sleep detection (—Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)

#### Frontend (React + TypeScript)

**Timer.tsx**
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞
- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (Start/Pause/Resume/Stop)
- –¢–æ–Ω–∫–∏–π –∫–ª–∏–µ–Ω—Ç (–≤—ã–∑—ã–≤–∞–µ—Ç Rust –∫–æ–º–∞–Ω–¥—ã)

**useTrackerStore.ts** (Zustand)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ UI —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
- –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è API –≤—ã–∑–æ–≤–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**useAuthStore.ts** (Zustand)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
- –ó–∞—â–∏—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤

**API Client** (`lib/api.ts`)
- HTTP –∫–ª–∏–µ–Ω—Ç (Axios)
- Token refresh interceptor
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

---

## ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–ù–´–ô –§–£–ù–ö–¶–ò–û–ù–ê–õ

### 1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è ‚úÖ

- ‚úÖ –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ (access_token + refresh_token)
- ‚úÖ Token refresh –ø—Ä–∏ 401
- ‚úÖ –ó–∞—â–∏—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤
- ‚úÖ –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –±–∞–≥–∏ –≤ —Ñ–æ—Ä–º–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (5 –±–∞–≥–æ–≤)

### 2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ ‚úÖ

- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å backend
- ‚úÖ –í—ã–±–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è —Ç—Ä–µ–∫–∏–Ω–≥–∞
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å —Ü–≤–µ—Ç–æ–≤—ã–º–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏

### 3. –¢—Ä–µ–∫–µ—Ä –≤—Ä–µ–º–µ–Ω–∏ ‚úÖ

- ‚úÖ **Start**: –ó–∞–ø—É—Å–∫ —Ç—Ä–µ–∫–µ—Ä–∞ —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º –ø—Ä–æ–µ–∫—Ç–æ–º
- ‚úÖ **Pause**: –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç—Ä–µ–∫–µ—Ä–∞
- ‚úÖ **Resume**: –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–∫–µ—Ä–∞
- ‚úÖ **Stop**: –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç—Ä–µ–∫–µ—Ä–∞
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ HH:MM:SS
- ‚úÖ –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞ –¥–µ–Ω—å
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±—Ä–æ—Å –≤ –ø–æ–ª–Ω–æ—á—å (day rollover)
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –ë–î
- ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞

### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ ‚úÖ

- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –º—ã—à–∏ –∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã —á–µ—Ä–µ–∑ Rust
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ heartbeat –Ω–∞ backend –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–∞—É–∑–∞ –ø—Ä–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –±–æ–ª–µ–µ N –º–∏–Ω—É—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 2)
- ‚úÖ –û–∫–Ω–æ –ø—Ä–æ—Å—Ç–æ—è (IdleWindow)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä–æ–≥–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### 5. –°–∫—Ä–∏–Ω—à–æ—Ç—ã ‚úÖ

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ –∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ –Ω–∞ backend API
- ‚úÖ Offline queue –¥–ª—è —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ –≤ UI

### 6. Offline Queue ‚úÖ

- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π –≤ SQLite –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–≤—è–∑–∏
- ‚úÖ Retry –º–µ—Ö–∞–Ω–∏–∑–º —Å exponential backoff
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫
- ‚úÖ Token refresh –≤–æ –≤—Ä–µ–º—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### 7. Day Rollover ‚úÖ

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±—Ä–æ—Å —Ç–∞–π–º–µ—Ä–∞ –ø—Ä–∏ —Å–º–µ–Ω–µ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω–æ–≥–æ –¥–Ω—è
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –¥–Ω—è
- ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—Å—á—ë—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å–ª–µ 00:00 –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–Ω—å
- ‚úÖ –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å rollover
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–≤–æ–π–Ω–æ–≥–æ rollover

### 8. Runtime Guards ‚úÖ

- ‚úÖ **Clock Skew Detection**: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è SystemTime –∏ Instant
- ‚úÖ **Timezone UTC Fix**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ UTC –¥–ª—è day boundaries
- ‚úÖ **SQLite Transactional Safety**: BEGIN IMMEDIATE/COMMIT/ROLLBACK
- ‚úÖ **Rollover Idempotency**: –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–≤–æ–π–Ω–æ–≥–æ rollover
- ‚úÖ **Recursive Protection**: MAX_RECURSION_DEPTH = 3
- ‚úÖ **Overflow Protection**: `saturating_add()` –¥–ª—è `accumulated_seconds`
- ‚úÖ **Sleep Detection**: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ–ª—å—à–∏—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä–∞–∑—Ä—ã–≤–æ–≤ (15 –º–∏–Ω—É—Ç)

### 9. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ‚úÖ

- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (tracing)
- ‚úÖ –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (info, warn, error)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª (–Ω–µ –≤ –±—Ä–∞—É–∑–µ—Ä)
- ‚úÖ –¢–æ–∫–µ–Ω—ã –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –ª–æ–≥–∏

### 10. UI/UX ‚úÖ

- ‚úÖ –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π UI (Tailwind CSS + Radix UI)
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –±–∞–≥–∏ UI (—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è, –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç—å, –≤–∏–¥–∏–º–æ—Å—Ç—å —Ç–µ–∫—Å—Ç–∞)
- ‚úÖ –û–∫–Ω–æ –ø—Ä–æ—Å—Ç–æ—è (IdleWindow)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –±—ã—Å—Ç—Ä—ã—Ö –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∫–ª–∏–∫–æ–≤

---

## üêõ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ë–ê–ì–ò

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)

1. ‚úÖ **UI –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**: –¢–∞–π–º–µ—Ä —à–µ–ª, –Ω–æ –∫–Ω–æ–ø–∫–∞ –Ω–µ –º–µ–Ω—è–ª–∞—Å—å
   - **–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ `timerState.state.state` (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `timerState.state`)
   - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å `#[serde(flatten)]`

2. ‚úÖ **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ - Persistence**: `resume()` –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –ë–î
   - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –î–æ–±–∞–≤–ª–µ–Ω `save_state()` –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ `Paused ‚Üí Running`

3. ‚úÖ **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ - Persistence**: `start()` (Paused‚ÜíRunning) –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –ë–î
   - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –î–æ–±–∞–≤–ª–µ–Ω `save_state()` –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ `Paused ‚Üí Running`

4. ‚úÖ **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ - State Check**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ `loadActiveTimeEntry`
   - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –¥–æ—Å—Ç—É–ø –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é (`timerState.state` –≤–º–µ—Å—Ç–æ `timerState.state.state`)

5. ‚úÖ **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ - Multiple Active Entries**: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ warning
   - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∞–º–æ–π –Ω–æ–≤–æ–π, –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

6. ‚úÖ **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ - App Close**: –ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –î–æ–±–∞–≤–ª–µ–Ω `beforeunload` event listener –∏ Tauri command `save_timer_state`

7. ‚úÖ **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ - Overflow**: –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è `accumulated_seconds`
   - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `saturating_add()` –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

8. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–∞—É–∑–∞**: –¢–∞–π–º–µ—Ä —Å–∞–º –ø–æ —Å–µ–±–µ –ø–∞—É–∑–∏–ª—Å—è
   - **–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ `checkIdleStatus` –∏ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π sleep detection
   - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è, —É–≤–µ–ª–∏—á–µ–Ω –ø–æ—Ä–æ–≥ sleep detection –¥–æ 15 –º–∏–Ω—É—Ç, –æ—Ç–∫–ª—é—á–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–∞—É–∑–∞ –¥–ª—è sleep detection

### –ë–∞–≥–∏ —Ñ–æ—Ä–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ 5 –±–∞–≥–æ–≤)

1. ‚úÖ **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π**: –¢–æ–∫–µ–Ω—ã —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å –¥–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–≤–µ—Ç–∞
2. ‚úÖ **–°—Ä–µ–¥–Ω–∏–π**: –û—à–∏–±–∫–∞ –Ω–µ –æ—á–∏—â–∞–ª–∞—Å—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–ª–µ–π
3. ‚úÖ **–ù–∏–∑–∫–∏–π**: –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –ø—É—Å—Ç–æ–π email –ø–µ—Ä–µ–¥ –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —Ñ–æ—Ä–º–∞—Ç–∞
4. ‚úÖ **–ù–∏–∑–∫–∏–π**: –ü–∞—Ä–æ–ª—å –Ω–µ –æ–±—Ä–µ–∑–∞–ª—Å—è (trim)
5. ‚úÖ **–ù–∏–∑–∫–∏–π**: Email –Ω–µ –æ—á–∏—â–∞–ª—Å—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞

### UI –±–∞–≥–∏ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)

1. ‚úÖ **–ù–µ–≤–∏–¥–∏–º—ã–π —Ç–µ–∫—Å—Ç –≤ input –ø–æ–ª—è—Ö**: –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª `text-foreground` –∫–ª–∞—Å—Å
2. ‚úÖ **–ù–∏–∑–∫–∏–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç**: –°–µ—Ä—ã–µ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" –∏ –∫–Ω–æ–ø–∫–∞ "–û–±–Ω–æ–≤–∏—Ç—å"
3. ‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è**: –¢–∞–π–º–µ—Ä —à–µ–ª, –Ω–æ –∫–Ω–æ–ø–∫–∞ –Ω–µ –º–µ–Ω—è–ª–∞—Å—å
4. ‚úÖ **Type mismatch**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è `#[serde(flatten)]` enum

---

## üîí –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ ‚úÖ

- ‚úÖ –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ SQLite (aes-gcm)
- ‚úÖ –¢–æ–∫–µ–Ω—ã –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –ª–æ–≥–∏
- ‚úÖ Token refresh –ø—Ä–∏ 401
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (email, –ø–∞—Ä–æ–ª—å)
- ‚úÖ SQLite —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è ‚ö†Ô∏è

- ‚ö†Ô∏è **Keychain –¥–ª—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è**: –°–µ–π—á–∞—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π –∫–ª—é—á
- ‚ö†Ô∏è **–í–∞–ª–∏–¥–∞—Ü–∏—è payload –≤ –æ—á–µ—Ä–µ–¥–∏**: –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

---

## üì¶ –ó–ê–í–ò–°–ò–ú–û–°–¢–ò

### Frontend

```json
{
  "react": "^19.1.0",
  "typescript": "~5.8.3",
  "vite": "^7.0.4",
  "zustand": "^5.0.9",
  "axios": "^1.13.2",
  "tailwindcss": "^3.4.19",
  "@tauri-apps/api": "^2"
}
```

### Backend

```toml
tauri = "2"
tokio = "1"
rusqlite = "0.31"
chrono = "0.4"
aes-gcm = "0.10"
tracing = "0.1"
reqwest = "0.12"
```

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### Unit Tests (Rust)

**–í—Å–µ–≥–æ:** 92 —Ç–µ—Å—Ç–∞ ‚úÖ

**–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:**
- TimerEngine: 32 —Ç–µ—Å—Ç–∞ (100% –ø–æ–∫—Ä—ã—Ç–∏–µ)
- Database: 35 —Ç–µ—Å—Ç–æ–≤ (~98% –ø–æ–∫—Ä—ã—Ç–∏–µ)
- SyncManager: 25 —Ç–µ—Å—Ç–æ–≤ (~100% –ø–æ–∫—Ä—ã—Ç–∏–µ)

**–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–µ—Å—Ç–æ–≤:**
- ‚úÖ FSM –ø–µ—Ä–µ—Ö–æ–¥—ã (–≤—Å–µ –≤–∞–ª–∏–¥–Ω—ã–µ –∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ)
- ‚úÖ –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ Day rollover
- ‚úÖ Overflow protection
- ‚úÖ Clock skew detection
- ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ Retry –º–µ—Ö–∞–Ω–∏–∑–º
- ‚úÖ Token refresh
- ‚úÖ Edge cases (corrupted DB, partial write, concurrent access)

### E2E Tests (Playwright)

**–í—Å–µ–≥–æ:** 8 —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ ‚úÖ

**–ü–æ–∫—Ä—ã—Ç–∏–µ:**
- ‚úÖ –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –°–º–µ–Ω–∞ –¥–Ω—è
- ‚úÖ –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –û–∫–Ω–æ –ø—Ä–æ—Å—Ç–æ—è
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ—á–µ—Ä–µ–¥–∏
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ URL –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

### –ù–µ –ø–æ–∫—Ä—ã—Ç–æ —Ç–µ—Å—Ç–∞–º–∏ ‚ö†Ô∏è

- ‚ö†Ô∏è ActivityMonitor (0 —Ç–µ—Å—Ç–æ–≤)
- ‚ö†Ô∏è Sleep/Wake handlers (0 —Ç–µ—Å—Ç–æ–≤)
- ‚ö†Ô∏è HTTP –æ–ø–µ—Ä–∞—Ü–∏–∏ SyncManager (—Ç—Ä–µ–±—É—é—Ç –º–æ–∫–æ–≤, —á–∞—Å—Ç–∏—á–Ω–æ –ø–æ–∫—Ä—ã—Ç–æ)

---

## üìã –≠–¢–ê–ü–´ –†–ê–ó–†–ê–ë–û–¢–ö–ò

### ‚úÖ –≠–¢–ê–ü 1: Timer Engine (CRITICAL) - –ó–ê–í–ï–†–®–ï–ù–û

- ‚úÖ –°–æ–∑–¥–∞–Ω TimerEngine –≤ Rust
- ‚úÖ –°—Ç—Ä–æ–≥–∞—è FSM
- ‚úÖ –ú–æ–Ω–æ—Ç–æ–Ω–Ω–æ–µ –≤—Ä–µ–º—è (`std::time::Instant`)
- ‚úÖ Tauri commands
- ‚úÖ TypeScript API
- ‚úÖ 100% –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

### ‚úÖ –≠–¢–ê–ü 1.5: Frontend = Thin Client - –ó–ê–í–ï–†–®–ï–ù–û

- ‚úÖ –£–¥–∞–ª–µ–Ω–∞ –≤—Å—è –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏ –∏–∑ frontend
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã `Date.now()`, `elapsed`, `session time`, `daily reset`
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã `localStorage` –∫–ª—é—á–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –≤—Ä–µ–º–µ–Ω–µ–º
- ‚úÖ `Timer.tsx` —Å—Ç–∞–ª –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º "render(state)"
- ‚úÖ `useTrackerStore.ts` —Å—Ç–∞–ª —Ç–æ–Ω–∫–∏–º –∫–ª–∏–µ–Ω—Ç–æ–º

### ‚úÖ –≠–¢–ê–ü 2: Strict State Machine (Rust Core) - –ó–ê–í–ï–†–®–ï–ù–û

- ‚úÖ `TimerState` enum (`Stopped`, `Running { started_at: Instant }`, `Paused`)
- ‚úÖ –°—Ç—Ä–æ–≥–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π
- ‚úÖ –í–æ–∑–≤—Ä–∞—Ç –æ—à–∏–±–æ–∫ –¥–ª—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
- ‚úÖ `accumulated_seconds` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ `pause` –∏ `stop`
- ‚úÖ `elapsed()` —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ `accumulated` –∏ `started_at_instant`
- ‚úÖ `TimerEngine` –∫–∞–∫ `Arc<Mutex<TimerEngine>>` –¥–ª—è thread safety

### ‚úÖ –≠–¢–ê–ü 3: SQLite + Offline Queue - –ó–ê–í–ï–†–®–ï–ù–û

- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è SQLite (`rusqlite`)
- ‚úÖ –¢–∞–±–ª–∏—Ü—ã: `time_entries`, `screenshots_queue`, `activities_queue`, `sync_jobs`
- ‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–Ω–∞—á–∞–ª–∞ –≤ SQLite, –ø–æ—Ç–æ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫ ‚Üí –æ—á–µ—Ä–µ–¥—å
- ‚úÖ Retry –º–µ—Ö–∞–Ω–∏–∑–º —Å exponential backoff

### ‚úÖ –≠–¢–ê–ü 4: Sleep / Wake Handling - –ó–ê–í–ï–†–®–ï–ù–û

- ‚úÖ –°–∏—Å—Ç–µ–º–Ω—ã–µ sleep/wake listeners
- ‚úÖ –ü—Ä–∏ sleep: –∑–∞–ø–∏—Å—å `Instant`, –ø–∞—É–∑–∞ —Ç–∞–π–º–µ—Ä–∞
- ‚úÖ –ü—Ä–∏ wake: –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –Ω–µ —Å—á–∏—Ç–∞–µ–º sleep –∫–∞–∫ —Ä–∞–±–æ—Ç—É
- ‚úÖ Sleep detection (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –±–µ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø–∞—É–∑—ã)

### ‚úÖ –≠–¢–ê–ü 4.5: Calendar Day Rollover (Midnight Boundary Fix) - –ó–ê–í–ï–†–®–ï–ù–û

- ‚úÖ `ensure_correct_day()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–º–µ–Ω—ã –¥–Ω—è
- ‚úÖ `rollover_day(old_day, new_day)` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–º–µ–Ω—ã –¥–Ω—è
- ‚úÖ –í—ã–∑–æ–≤ `ensure_correct_day()` –≤ –Ω–∞—á–∞–ª–µ –≤—Å–µ—Ö –ø—É–±–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
- ‚úÖ –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å rollover
- ‚úÖ `RUNNING` –Ω–æ—á—å—é ‚Üí `STOPPED` —É—Ç—Ä–æ–º
- ‚úÖ –í—Ä–µ–º—è –ø–æ—Å–ª–µ 00:00 –Ω–µ –∑–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–Ω—å
- ‚úÖ Unit —Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### ‚ö†Ô∏è –≠–¢–ê–ü 5: Active Window Tracking (MINIMUM) - –ß–ê–°–¢–ò–ß–ù–û

- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ AppleScript (–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ Objective-C)
- ‚úÖ `get_active_window_info()` —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚ö†Ô∏è –ù–µ—Ç unit —Ç–µ—Å—Ç–æ–≤ –¥–ª—è ActivityMonitor
- ‚ö†Ô∏è –ù–µ—Ç unit —Ç–µ—Å—Ç–æ–≤ –¥–ª—è Sleep/Wake handlers

---

## üéØ –ü–†–ò–û–†–ò–¢–ï–¢–´ –î–õ–Ø PRODUCTION

### –ö—Ä–∏—Ç–∏—á–Ω–æ (HIGH) üî¥

1. ‚úÖ **TimerEngine** - 100% –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ (–∑–∞–≤–µ—Ä—à–µ–Ω–æ)
2. ‚úÖ **Database** - —Ç–µ—Å—Ç—ã –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (–∑–∞–≤–µ—Ä—à–µ–Ω–æ)
3. ‚úÖ **SyncManager** - —Ç–µ—Å—Ç—ã –¥–ª—è retry –∏ token refresh (–∑–∞–≤–µ—Ä—à–µ–Ω–æ)
4. ‚úÖ **UI —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –±–∞–≥–∏ (–∑–∞–≤–µ—Ä—à–µ–Ω–æ)
5. ‚úÖ **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏ (–∑–∞–≤–µ—Ä—à–µ–Ω–æ)

### –í–∞–∂–Ω–æ (MEDIUM) üü°

6. ‚ö†Ô∏è **ActivityMonitor** - –¥–æ–±–∞–≤–∏—Ç—å unit —Ç–µ—Å—Ç—ã
7. ‚ö†Ô∏è **Sleep/Wake handlers** - –¥–æ–±–∞–≤–∏—Ç—å unit —Ç–µ—Å—Ç—ã
8. ‚ö†Ô∏è **Keychain** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Keychain –¥–ª—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

### –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ (LOW) üü¢

9. ‚ö†Ô∏è **Hotkeys** - —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≥–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
10. ‚ö†Ô∏è **System Tray Timer** - —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç–∞–π–º–µ—Ä –≤ —Å–∏—Å—Ç–µ–º–Ω–æ–º —Ç—Ä–µ–µ
11. ‚ö†Ô∏è **–í–∞–ª–∏–¥–∞—Ü–∏—è payload** - –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –≤ –æ—á–µ—Ä–µ–¥–∏

---

## üìä –ú–ï–¢–†–ò–ö–ò –ö–ê–ß–ï–°–¢–í–ê

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ü–æ–∫—Ä—ã—Ç–∏–µ | –°—Ç–∞—Ç—É—Å |
|-----------|----------|--------|
| TimerEngine | 100% | ‚úÖ Production-ready |
| Database | ~98% | ‚úÖ Production-ready |
| SyncManager | ~100% | ‚úÖ Production-ready |
| ActivityMonitor | 0% | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–æ–≤ |
| Sleep/Wake | 0% | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–æ–≤ |
| **–û–±—â–µ–µ** | **~95%** | ‚úÖ **–•–æ—Ä–æ—à–æ** |

### –ö–æ–¥–æ–≤–∞—è –±–∞–∑–∞

- **Rust:** 5,018 —Å—Ç—Ä–æ–∫ (lib.rs)
- **TypeScript:** 4,432 —Å—Ç—Ä–æ–∫–∏ (22 —Ñ–∞–π–ª–∞)
- **–¢–µ—Å—Ç—ã:** 92 unit —Ç–µ—Å—Ç–∞ + 8 E2E —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** 28 markdown —Ñ–∞–π–ª–æ–≤

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- ‚úÖ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –ù–∏–∑–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- ‚úÖ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤ —Ñ–æ–Ω–µ
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ SQLite –∑–∞–ø—Ä–æ—Å—ã

---

## üöÄ –ì–û–¢–û–í–ù–û–°–¢–¨ –ö PRODUCTION

### ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ production

- ‚úÖ –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã (TimerEngine, Database, SyncManager)
- ‚úÖ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (–≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã)
- ‚úÖ UI/UX (–≤—Å–µ –±–∞–≥–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã)
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (95% –ø–æ–∫—Ä—ã—Ç–∏–µ)
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤, –≤–∞–ª–∏–¥–∞—Ü–∏—è)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (retry, offline queue)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ)

### ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è

- ‚ö†Ô∏è ActivityMonitor unit —Ç–µ—Å—Ç—ã
- ‚ö†Ô∏è Sleep/Wake handlers unit —Ç–µ—Å—Ç—ã
- ‚ö†Ô∏è Keychain –¥–ª—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- ‚ö†Ô∏è Hotkeys –∏ system tray timer

### ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

- ‚ùå Hotkeys (–≥–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏)
- ‚ùå System Tray Timer (—Ç–∞–π–º–µ—Ä –≤ —Å–∏—Å—Ç–µ–º–Ω–æ–º —Ç—Ä–µ–µ)
- ‚ùå –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã

---

## üìù –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

### –û—Ç—á–µ—Ç—ã

1. ‚úÖ `DEVELOPMENT_STATUS_REPORT.md` - –°—Ç–∞—Ç—É—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
2. ‚úÖ `CORE_SYSTEM_STATUS.md` - –°—Ç–∞—Ç—É—Å —è–¥—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
3. ‚úÖ `TIME_TRACKER_AUDIT_REPORT.md` - –ê—É–¥–∏—Ç —Ç–∞–π–º-—Ç—Ä–µ–∫–µ—Ä–∞
4. ‚úÖ `CURRENT_ISSUES_REPORT.md` - –¢–µ–∫—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
5. ‚úÖ `LOGIN_BUGS_REPORT.md` - –ë–∞–≥–∏ —Ñ–æ—Ä–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
6. ‚úÖ `UI_BUGS_REPORT.md` - –ë–∞–≥–∏ UI
7. ‚úÖ `TEST_COVERAGE_REPORT.md` - –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏
8. ‚úÖ `HARDENING_FIXES.md` - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –≠—Ç–∞–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

1. ‚úÖ `ETAP1_TIMER_ENGINE.md` - Timer Engine
2. ‚úÖ `ETAP1_5_FRONTEND_REPORT.md` - Frontend –∫–∞–∫ —Ç–æ–Ω–∫–∏–π –∫–ª–∏–µ–Ω—Ç
3. ‚úÖ `ETAP2_FSM_REPORT.md` - –°—Ç—Ä–æ–≥–∞—è FSM
4. ‚úÖ `ETAP3_SQLITE_REPORT.md` - SQLite + Offline Queue
5. ‚úÖ `ETAP4_SLEEP_WAKE_REPORT.md` - Sleep/Wake Handling
6. ‚úÖ `CLOCK_SKEW_FIX.md` - Clock Skew Detection
7. ‚úÖ `TIMEZONE_UTC_FIX.md` - Timezone UTC Fix
8. ‚úÖ `SQLITE_TRANSACTIONAL_FIX.md` - SQLite Transactional Safety

---

## üéâ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–ü—Ä–æ–µ–∫—Ç **Hubnity** –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ **90% –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ production**.

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚úÖ –ù–∞–¥–µ–∂–Ω–æ–µ —è–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã (TimerEngine, Database, SyncManager)
- ‚úÖ –í—ã—Å–æ–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ (95%)
- ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- ‚úÖ –°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (Rust + React)
- ‚úÖ Offline-first –ø–æ–¥—Ö–æ–¥
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤)

**–û–±–ª–∞—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è:**
- ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å unit —Ç–µ—Å—Ç—ã –¥–ª—è ActivityMonitor –∏ Sleep/Wake handlers
- ‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Keychain –¥–ª—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- ‚ö†Ô∏è –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å hotkeys –∏ system tray timer

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. –î–æ–±–∞–≤–∏—Ç—å unit —Ç–µ—Å—Ç—ã –¥–ª—è ActivityMonitor –∏ Sleep/Wake handlers (2-3 —á–∞—Å–∞)
2. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Keychain –¥–ª—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (2-3 —á–∞—Å–∞)
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å hotkeys –∏ system tray timer (4-5 —á–∞—Å–æ–≤)

**–ò—Ç–æ–≥–æ:** 8-11 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã –¥–ª—è –¥–æ–≤–µ–¥–µ–Ω–∏—è –¥–æ 100% –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ production.

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç—á–µ—Ç–∞:** 2025-01-08  
**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞:** 0.1.0
